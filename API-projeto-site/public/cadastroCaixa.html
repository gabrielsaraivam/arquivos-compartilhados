<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Overall</title>

     <!-- script do google charts -->
     <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
     <script type="text/javascript" src="./funcoes.js"></script>
     <script type="text/javascript" src="./funcoesCargo.js"></script>
 
     <!-- scripts do Chart.js -->
     <script type="text/javascript" src="https://www.chartjs.org/dist/2.8.0/Chart.min.js"></script>

     <link rel="sortcut icon" href="./img/logo.png" type="image/x-icon"/>

    <script src="./js/bootstrap.js"></script>
    <link rel="stylesheet" href="./css/bootstrap.css">
    <link rel="stylesheet" href="./styleDash.css">

    <link href="https://fonts.googleapis.com/css?family=Poppins:300,400,500,600,700,800,900" rel="stylesheet">
		
    <script src="https://kit.fontawesome.com/fee5906543.js" crossorigin="anonymous"></script>
		<link rel="stylesheet" href="./cssSB/style.css">

    <script src="./funcoesLocalizacao.js">
      
    </script>
</head>
<body>
  
    <div class="wrapper d-flex align-items-stretch">
      <nav id="sidebar" class="menu">
        <div class="custom-menu">
          <button type="button" id="sidebarCollapse" class="btn btn-primary">
            <i class="fa fa-bars"></i>
            <span class="sr-only">Toggle Menu</span>
          </button>
        </div>
        <div class="" >
          <h1 class="p-4"><a href="index.html" id="imgLogo"><img src="./img/logo-black.png" alt=""></a></h1>
          <ul class="list-unstyled components mb-5">
            <li class="pl-4 pr-4">
              <a href="dashboardGerente.html" id="aDashboard"><span class="fas fa-chart-pie mr-3"></span>Dashboard</a>
            </li>
            <li class="pl-4 pr-4">
                <a href="cadastroUsuario.html"><span class="fa fa-user mr-3"></span>Cadastrar Usuário</a>
            </li>
            <li class="pl-4 pr-4  li-active">
              <a href="cadastroCaixa.html" id="aCaixa"><span class="fas fa-credit-card mr-3"></span>Caixas Eletrônicos</a>
            </li>
            <li class="pl-4 pr-4">
              <a href="#" onclick="apiGeo()"><span class="fas fa-map-marked-alt mr-3"></span>Geolocalização</a>
            </li>
            <li class="pl-4 pr-4">
              <a href="billing.html" id="aBilling"><span class="fab fa-aws mr-3"></span>Billing</a>
            </li>

            <li class="pl-4 pr-4">
              <a href="#" onclick="logoff()"><span class="fa fas fa-sign-out-alt mr-3"></span>Logoff</a>
            </li>
          </ul>

          <div class="footer">
            <p><!-- Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0. -->
              Copyright &copy;2021</a>
              <!-- Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0. --></p>
          </div>

        </div>
      </nav>

      <!-- <div class="container">
        <div class="container">
          <div class="row">
            <div class="col-lg-12 col-md-12" style="background-color: red;"></div>
          </div>
        </div> -->
        <div id="content" class="p-4 p-md-5 pt-5">
          <div class="row container col-md-12 col-lg-12 col-sm-12 col-xs-12 col-xl-12 border-bottom">
            <h6 class="mr-auto">Empresa</h6>
            <h6 id="usuario" class="ml-auto"></h6>
          </div>

          <div class="row mt-2 container col-12">
            <h2 class="color-text">Meus caixas: <span id="myCashiers">0</span></h2>
            <div class="col-7  col-sm-4 col-md-4 col-lg-3 ml-auto p-0 pt-2" >
              <div class="col-12 p-0">
                <label class="col-5 col-sm-7 col-lg-5 p-0 row ml-auto">
                  <input type="checkbox" id="switch"> 
                  <div style="height: 3vh;">
                    <span class="fa fa-sun-o"></span>
                  </div>
                  <div class="check col-6 ml-2 mr-2"></div> 
                  <div style="height: 3vh;">
                    <span class="fa fa-moon-o"></span>
                  </div>
                </label>
              </div>
            </div>
          </div>
          <div class="row container pt-3">
            <h4 class="color-text">Cadastrar nova máquina</h4>
          </div>

          <form id="form_cadastro_caixa" method="post" onsubmit="return cadastrar()">
          
          <div class="row container pt-5 mx-auto">
            <h6 class="color-text mr-auto col-5">Latitude:</h6>
            <h6 class="color-text mr-auto col-5">Longitude:</h6>
          </div>

          <div class="row container mx-auto">
            <input name="latitude" type="text" class="mr-auto col-5">
            <input name="longitude"  type="text" class="mr-auto col-5">
          </div>

          <div class="row container pt-5 mx-auto">
            <h6 class="color-text mr-auto col-5">Número de série:</h6>
            <h6 class="color-text mr-auto col-5">Usuário:</h6>
          </div>

          <div class="row container mx-auto">
            <input name="numeroSerie" type="text" class="mr-auto col-5">
            <input name="usuario" type="text" class="mr-auto col-5">
          </div>

          <div class="row container pt-5 mx-auto">
            <h6 class="color-text mr-auto col-5">Senha:</h6>
          </div>   

          <div class="row container mx-auto">
            <input id="senha" name="senha" type="password" class="mr-auto col-5">
            <input type="submit" value="Cadastrar" id="btn_cadastrar_caixa" class="btn btn-dark col-5 mr-auto">
          </div>
          
          <div class="row container mx-auto mr-auto mr-1">
            <input type="checkbox" onclick="mostrarOcultarSenha()" class="my-auto mr-2"> 
            <span  class="my-auto"> Exibir Senha</span>
          </div>
        
        
        </form>
    </div>
  
</body>
</html>

<script>

  verificarCargo();

  function mostrarOcultarSenha(){
    
    var senha=document.getElementById("senha");

    if(senha.type=="password"){
      senha.type="text";
    }else{
      senha.type="password";
    }

  }


</script>

<script>

function cadastrar() {
        
        var formulario = new URLSearchParams(new FormData(form_cadastro_caixa));
        fetch(`/tblCaixaEletronicos/cadastrar/${id_usuario}`, {
            method: "POST",
            body: formulario
        }).then(function (response) {
            
            if (response.ok) {

                window.location.href='cadastroCaixa.html';

            } else {

                console.log('Erro de cadastro!');
                response.text().then(function (resposta) {
                    alert(resposta)
                });
                
            }
        });

        return false;
    }

                   
</script>

<script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>

<script src="./jsSb/jquery.min.js"></script>
<script src="./jsSb/popper.js"></script>
<script src="./jsSb/bootstrap.min.js"></script>
<script src="./jsSb/main.js"></script>

<script src="https://cdn.jsdelivr.net/npm/js-cookie@3.0.1/dist/js.cookie.min.js"></script>

<!-- max-width: 991.98px -->

<script>

  window.addEventListener('resize', function ajustarSideBar() {
    //var altura = window.innerHeight;
    var largura = window.innerWidth;

    if (largura < 1258) 
        // document.getElementsByClassName('menu')[0].className = 'responsivemenu';
        sidebar.style = "position: fixed; z-index: 9999; height: 100%;"

    else sidebar.style = ""
});

$(document).ready(function() {
  var largura = $(window).width();

  if (largura < 1258) 
        // document.getElementsByClassName('menu')[0].className = 'responsivemenu';
        sidebar.style = "position: fixed; z-index: 9999; height: 100%;"

    else sidebar.style = ""
});

const $html = document.querySelector('html')
    const $checkbox = document.querySelector('#switch')

    $checkbox.addEventListener('change', function(){
        $html.classList.toggle('dark-mode')
    })


var otherCheckbox = document.querySelector ('#switch');

otherCheckbox.onchange = function () {
  if (otherCheckbox.checked) {
    imgLogo.innerHTML=`<img src="./img/logo-white.png" alt="aa">`
  } else{
    imgLogo.innerHTML=`<img src="./img/logo-black.png" alt="aa">`
  }
};
</script>

<script>

id_usuario = sessionStorage.id_usuario_meuapp;

window.onload = quantidadeCaixas();

function quantidadeCaixas(){
  var cargo = sessionStorage.cargo_usuario_meuapp;
  var fkEmpresa = sessionStorage.fkEmpresa_usuario_meuapp;
  if(cargo == "Gerente"){
    id_usuario = fkEmpresa;
  }
  fetch(`/tblCaixaEletronicos/caixas/${id_usuario}`, { cache: 'no-store' }).then(function (response) {
          if (response.ok) {
              response.json().then(function (resposta) {
                  console.log(`Dados recebidos: ${JSON.stringify(resposta)}`);
                  
                  resposta.reverse();
                  myCashiers.innerHTML = `${JSON.stringify(resposta[0].qtdCaixas)}`
              });
          } else {
              console.error('Nenhum dado encontrado ou erro na API');
          }
      })
          .catch(function (error) {
              console.error(`Erro na obtenção dos dados p/ gráfico: ${error.message}`);
          });
}

function apiGeo(){
    for(var i = 1; i<=Cookies.get('qtdLocalizacao'); i++){
      Cookies.remove(`alertaAtivo${i}`);
    }

    getLocalizacao();
    window.open("http://localhost:8080/");
  }

</script>